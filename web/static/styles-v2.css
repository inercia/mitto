/* Mitto Web Interface - V2 Styles (Clawdbot-inspired) */
/* This stylesheet provides a modern, polished look with dark/light theme support */

@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

/* =============================================================================
   CSS Custom Properties (Design Tokens)
   ============================================================================= */

:root {
    /* Light theme (default) */
    --bg: #fafafa;
    --bg-accent: #f5f5f5;
    --bg-elevated: #ffffff;
    --bg-hover: #f0f0f0;
    --bg-muted: #f0f0f0;
    --card: #ffffff;
    --card-foreground: #18181b;
    --card-highlight: rgba(0, 0, 0, 0.03);

    --text: #3f3f46;
    --text-strong: #18181b;
    --muted: #71717a;
    --muted-strong: #52525b;

    --border: #e4e4e7;
    --border-strong: #d4d4d8;
    --border-hover: #a1a1aa;

    --accent: #dc2626;
    --accent-hover: #ef4444;
    --accent-subtle: rgba(220, 38, 38, 0.12);
    --accent-foreground: #ffffff;
    --accent-glow: rgba(220, 38, 38, 0.15);

    --ok: #16a34a;
    --ok-subtle: rgba(22, 163, 74, 0.1);
    --warn: #d97706;
    --warn-subtle: rgba(217, 119, 6, 0.1);
    --danger: #dc2626;
    --danger-subtle: rgba(220, 38, 38, 0.1);
    --info: #2563eb;
    --info-subtle: rgba(37, 99, 235, 0.1);

    --focus-ring: 0 0 0 2px var(--bg), 0 0 0 4px var(--accent);

    --mono: "JetBrains Mono", ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, monospace;
    --font-body: "Space Grotesk", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(0, 0, 0, 0.04);
    --shadow-lg: 0 12px 28px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(0, 0, 0, 0.04);

    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    --radius-full: 9999px;

    --duration-fast: 0.12s;
    --duration-normal: 0.2s;
    --ease-out: cubic-bezier(0.16, 1, 0.3, 1);

    color-scheme: light;
}

/* Dark theme */
:root.dark, .dark {
    --bg: #12141a;
    --bg-accent: #14161d;
    --bg-elevated: #1a1d25;
    --bg-hover: #262a35;
    --bg-muted: #262a35;
    --card: #181b22;
    --card-foreground: #f4f4f5;
    --card-highlight: rgba(255, 255, 255, 0.05);

    --text: #e4e4e7;
    --text-strong: #fafafa;
    --muted: #a1a1aa;
    --muted-strong: #71717a;

    --border: #27272a;
    --border-strong: #3f3f46;
    --border-hover: #52525b;

    --accent: #ff5c5c;
    --accent-hover: #ff7070;
    --accent-subtle: rgba(255, 92, 92, 0.15);
    --accent-foreground: #fafafa;
    --accent-glow: rgba(255, 92, 92, 0.25);

    --ok: #22c55e;
    --ok-subtle: rgba(34, 197, 94, 0.12);
    --warn: #f59e0b;
    --warn-subtle: rgba(245, 158, 11, 0.12);
    --danger: #ef4444;
    --danger-subtle: rgba(239, 68, 68, 0.12);
    --info: #3b82f6;
    --info-subtle: rgba(59, 130, 246, 0.12);

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.2);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.03);
    --shadow-lg: 0 12px 28px rgba(0, 0, 0, 0.35), 0 0 0 1px rgba(255, 255, 255, 0.03);

    color-scheme: dark;
}

/* =============================================================================
   Override Mitto CSS Variables (from index.html)
   These ensure the v2 theme colors are applied to the base layout
   Using direct color values to avoid CSS variable resolution issues
   ============================================================================= */

.v2-theme {
    /* Light theme - direct color values */
    --mitto-bg: #fafafa;
    --mitto-sidebar: #ffffff;
    --mitto-chat: #f5f5f5;
    --mitto-input: #ffffff;
    --mitto-input-box: #f0f0f0;
    --mitto-user: #e5e7eb;
    --mitto-user-text: #18181b;
    --mitto-user-border: #dc2626;
    --mitto-agent: #ffffff;
    --mitto-text: #3f3f46;
    --mitto-text-secondary: #71717a;
    --mitto-border: #e4e4e7;
}

.v2-theme.dark, .v2-theme .dark {
    /* Dark theme - direct color values */
    --mitto-bg: #12141a;
    --mitto-sidebar: #1a1d25;
    --mitto-chat: #14161d;
    --mitto-input: #1a1d25;
    --mitto-input-box: #262a35;
    --mitto-user: #ff5c5c;
    --mitto-agent: #181b22;
    --mitto-text: #e4e4e7;
    --mitto-text-secondary: #71717a;
    --mitto-border: #27272a;
}

/* =============================================================================
   Base Styles
   ============================================================================= */

* {
    box-sizing: border-box;
}

html, body {
    height: 100%;
    margin: 0;
}

body {
    font-family: var(--font-body);
    font-size: 14px;
    line-height: 1.55;
    letter-spacing: -0.02em;
    background: var(--bg);
    color: var(--text);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

a {
    color: var(--accent);
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

::selection {
    background: var(--accent-subtle);
    color: var(--text-strong);
}

/* Scrollbar styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--border-strong);
}

.scrollbar-hide::-webkit-scrollbar { display: none; }
.scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

/* =============================================================================
   Animations
   ============================================================================= */

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes scaleIn {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}

@keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

@keyframes pulse-subtle {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

@keyframes blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
}

@keyframes streaming-pulse {
    0%, 100% { border-color: var(--border); }
    50% { border-color: var(--accent); }
}

.message-enter { animation: fadeIn 0.2s var(--ease-out); }

/* Streaming cursor */
.streaming-cursor::after {
    content: 'â–‹';
    animation: blink 1s infinite;
    color: var(--accent);
    margin-left: 2px;
}

/* =============================================================================
   Theme Toggle (3-way: System/Light/Dark)
   ============================================================================= */

.theme-toggle-v2 {
    --theme-item: 28px;
    --theme-gap: 2px;
    --theme-pad: 3px;
    display: inline-flex;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-full);
    padding: var(--theme-pad);
}

.theme-toggle-v2__track {
    display: flex;
    gap: var(--theme-gap);
    position: relative;
}

.theme-toggle-v2__indicator {
    position: absolute;
    width: var(--theme-item);
    height: var(--theme-item);
    background: var(--accent);
    border-radius: var(--radius-full);
    transition: transform var(--duration-normal) var(--ease-out);
    z-index: 0;
}

.theme-toggle-v2__button {
    width: var(--theme-item);
    height: var(--theme-item);
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    border-radius: var(--radius-full);
    cursor: pointer;
    color: var(--muted);
    transition: color var(--duration-fast);
    position: relative;
    z-index: 1;
}

.theme-toggle-v2__button:hover {
    color: var(--text);
}

.theme-toggle-v2__button.active {
    color: var(--accent-foreground);
}

.theme-toggle-v2__button svg {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
    stroke-width: 1.5px;
    stroke-linecap: round;
    stroke-linejoin: round;
}

/* Legacy toggle (simple switch) */
.theme-toggle {
    position: relative;
    width: 48px;
    height: 24px;
    background: var(--bg-elevated);
    border: 1px solid var(--border);
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: background var(--duration-normal), border-color var(--duration-normal);
}

.theme-toggle::after {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 18px;
    height: 18px;
    background: var(--text);
    border-radius: 50%;
    transition: transform var(--duration-normal) var(--ease-out);
    box-shadow: var(--shadow-sm);
}

.theme-toggle.dark::after {
    transform: translateX(24px);
}

/* =============================================================================
   Shell Layout
   ============================================================================= */

.mitto-shell {
    display: grid;
    grid-template-columns: 260px minmax(0, 1fr);
    grid-template-rows: 56px 1fr;
    grid-template-areas:
        "topbar topbar"
        "sidebar content";
    height: 100vh;
    overflow: hidden;
}

@supports (height: 100dvh) {
    .mitto-shell { height: 100dvh; }
}

/* =============================================================================
   Topbar / Header
   ============================================================================= */

.mitto-topbar {
    grid-area: topbar;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    padding: 0 20px;
    height: 56px;
    border-bottom: 1px solid var(--border);
    background: var(--bg);
}

.mitto-topbar__left {
    display: flex;
    align-items: center;
    gap: 12px;
}

.mitto-topbar__right {
    display: flex;
    align-items: center;
    gap: 12px;
}

.mitto-brand {
    display: flex;
    align-items: center;
    gap: 10px;
}

.mitto-brand__logo {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent);
}

.mitto-brand__logo svg {
    width: 100%;
    height: 100%;
}

.mitto-brand__text {
    display: flex;
    flex-direction: column;
    gap: 1px;
}

.mitto-brand__title {
    font-size: 16px;
    font-weight: 700;
    letter-spacing: -0.03em;
    line-height: 1.1;
    color: var(--text-strong);
}

.mitto-brand__sub {
    font-size: 10px;
    font-weight: 500;
    color: var(--muted);
    letter-spacing: 0.05em;
    text-transform: uppercase;
    line-height: 1;
}

/* Status pill */
.mitto-status-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    font-size: 12px;
    font-weight: 500;
    border: 1px solid var(--border);
    border-radius: var(--radius-full);
    background: var(--bg-elevated);
}

.mitto-status-pill--connected {
    border-color: var(--ok-subtle);
    color: var(--ok);
}

.mitto-status-pill--disconnected {
    border-color: var(--danger-subtle);
    color: var(--danger);
}

.mitto-status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
}

/* =============================================================================
   Sidebar
   ============================================================================= */

.mitto-sidebar {
    grid-area: sidebar;
    display: flex;
    flex-direction: column;
    background: var(--bg);
    border-right: 1px solid var(--border);
    overflow: hidden;
}

.mitto-sidebar__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px;
    border-bottom: 1px solid var(--border);
}

.mitto-sidebar__title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-strong);
}

.mitto-sidebar__content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
}

/* =============================================================================
   Session List
   ============================================================================= */

.mitto-session-item {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 8px;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    transition: background var(--duration-fast), border-color var(--duration-fast);
}

.mitto-session-item:hover {
    background: var(--bg-hover);
}

.mitto-session-item--active {
    background: var(--accent-subtle);
    border-left: 2px solid var(--accent);
}

.mitto-session-item__content {
    flex: 1;
    min-width: 0;
}

.mitto-session-item__name {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    font-weight: 500;
    color: var(--text);
}

.mitto-session-item__name .status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--ok);
    flex-shrink: 0;
}

.mitto-session-item__meta {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 4px;
    font-size: 11px;
    color: var(--muted);
}

.mitto-session-item__badge {
    padding: 2px 6px;
    font-size: 10px;
    font-weight: 500;
    border-radius: var(--radius-sm);
    background: var(--bg-muted);
    color: var(--muted);
}

.mitto-session-item__actions {
    display: flex;
    gap: 4px;
    opacity: 0;
    transition: opacity var(--duration-fast);
}

.mitto-session-item:hover .mitto-session-item__actions {
    opacity: 1;
}

/* =============================================================================
   Buttons
   ============================================================================= */

.mitto-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 10px 16px;
    font-family: var(--font-body);
    font-size: 13px;
    font-weight: 500;
    line-height: 1;
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-elevated);
    color: var(--text);
    cursor: pointer;
    transition: background var(--duration-fast), border-color var(--duration-fast), color var(--duration-fast), box-shadow var(--duration-fast);
}

.mitto-btn:hover {
    background: var(--bg-hover);
    border-color: var(--border-strong);
}

.mitto-btn:focus-visible {
    outline: none;
    box-shadow: var(--focus-ring);
}

.mitto-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.mitto-btn--primary {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--accent-foreground);
}

.mitto-btn--primary:hover {
    background: var(--accent-hover);
    border-color: var(--accent-hover);
}

.mitto-btn--danger {
    background: var(--danger-subtle);
    border-color: var(--danger);
    color: var(--danger);
}

.mitto-btn--danger:hover {
    background: var(--danger);
    color: var(--accent-foreground);
}

.mitto-btn--icon {
    padding: 8px;
    min-width: 36px;
    height: 36px;
}

.mitto-btn--icon svg {
    width: 18px;
    height: 18px;
    stroke: currentColor;
    fill: none;
    stroke-width: 1.5px;
    stroke-linecap: round;
    stroke-linejoin: round;
}

.mitto-btn--sm {
    padding: 6px 12px;
    font-size: 12px;
}

.mitto-btn--sm.mitto-btn--icon {
    padding: 6px;
    min-width: 28px;
    height: 28px;
}

.mitto-btn--sm.mitto-btn--icon svg {
    width: 14px;
    height: 14px;
}

/* =============================================================================
   Content Area
   ============================================================================= */

.mitto-content {
    grid-area: content;
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
    background: var(--bg-accent);
}

/* Dark mode uses bg-accent which is already set via CSS variables */

/* =============================================================================
   Chat Container
   ============================================================================= */

.mitto-chat {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    overflow: hidden;
}

.mitto-chat__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    padding: 12px 20px;
    border-bottom: 1px solid var(--border);
    background: var(--bg);
}

.mitto-chat__title {
    font-size: 16px;
    font-weight: 600;
    color: var(--text-strong);
}

.mitto-chat__subtitle {
    font-size: 12px;
    color: var(--muted);
    margin-top: 2px;
}

/* =============================================================================
   Message Thread
   ============================================================================= */

.mitto-thread {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 16px 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

/* Message group (avatar + messages) */
.mitto-msg-group {
    display: flex;
    gap: 12px;
    align-items: flex-start;
}

.mitto-msg-group--user {
    flex-direction: row-reverse;
}

.mitto-msg-avatar {
    width: 36px;
    height: 36px;
    border-radius: var(--radius-md);
    background: var(--bg-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 13px;
    flex-shrink: 0;
    color: var(--muted);
}

.mitto-msg-avatar--user {
    background: var(--accent-subtle);
    color: var(--accent);
}

.mitto-msg-avatar--agent {
    background: var(--info-subtle);
    color: var(--info);
}

.mitto-msg-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
    max-width: min(700px, calc(100% - 60px));
}

.mitto-msg-group--user .mitto-msg-content {
    align-items: flex-end;
}

/* Message bubble */
.mitto-bubble {
    position: relative;
    display: inline-block;
    padding: 10px 14px;
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    background: var(--card);
    color: var(--text);
    max-width: 100%;
    word-wrap: break-word;
    transition: background var(--duration-fast), border-color var(--duration-fast);
    box-shadow: inset 0 1px 0 var(--card-highlight);
}

.mitto-bubble:hover {
    background: var(--bg-hover);
}

.mitto-bubble--user {
    background: rgba(251, 146, 60, 0.12);
    border-color: rgba(234, 88, 12, 0.2);
}

.dark .mitto-bubble--user {
    background: var(--accent-subtle);
    border-color: transparent;
}

.mitto-bubble--streaming {
    animation: streaming-pulse 1.5s ease-out infinite;
}

/* Thought bubble */
.mitto-bubble--thought {
    border: 1px dashed var(--border-strong);
    background: var(--bg-muted);
    color: var(--muted);
    font-size: 13px;
}

/* Tool card */
.mitto-tool-card {
    margin-top: 8px;
    padding: 12px;
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--card);
    transition: border-color var(--duration-fast), background var(--duration-fast);
}

.mitto-tool-card:hover {
    border-color: var(--border-strong);
    background: var(--bg-hover);
}

.mitto-tool-card__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
}

.mitto-tool-card__title {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-weight: 600;
    font-family: var(--mono);
}

.mitto-tool-card__icon {
    width: 14px;
    height: 14px;
    color: var(--muted);
}

.mitto-tool-card__icon svg {
    width: 100%;
    height: 100%;
    stroke: currentColor;
    fill: none;
    stroke-width: 1.5px;
}

.mitto-tool-card__status {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: var(--ok);
}

.mitto-tool-card__status svg {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
    stroke-width: 2px;
}

.mitto-tool-card__detail {
    margin-top: 4px;
    font-size: 11px;
    color: var(--muted);
}

/* Message timestamp */
.mitto-msg-time {
    font-size: 11px;
    color: var(--muted);
    opacity: 0.7;
}

/* =============================================================================
   Chat Compose
   ============================================================================= */

.mitto-compose {
    display: flex;
    align-items: stretch;
    gap: 12px;
    padding: 16px 20px;
    background: linear-gradient(to bottom, transparent, var(--bg-muted) 20%);
    border-top: 1px solid var(--border);
}

.mitto-compose__field {
    flex: 1;
    min-width: 0;
}

.mitto-compose__textarea {
    width: 100%;
    min-height: 44px;
    max-height: 200px;
    padding: 10px 14px;
    font-family: var(--font-body);
    font-size: 14px;
    line-height: 1.5;
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    background: var(--card);
    color: var(--text);
    resize: vertical;
    outline: none;
    transition: border-color var(--duration-fast), box-shadow var(--duration-fast);
}

.mitto-compose__textarea::placeholder {
    color: var(--muted);
}

.mitto-compose__textarea:focus {
    border-color: var(--accent);
    box-shadow: var(--focus-ring);
}

.mitto-compose__textarea:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.mitto-compose__actions {
    display: flex;
    align-items: flex-end;
    gap: 8px;
}

/* =============================================================================
   Markdown Content
   ============================================================================= */

.markdown-content {
    line-height: 1.6;
    word-wrap: break-word;
    overflow-wrap: break-word;
    color: var(--text);
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3,
.markdown-content h4 {
    color: var(--text-strong);
    font-weight: 600;
    margin: 1em 0 0.5em;
    line-height: 1.3;
}

.markdown-content h1 {
    font-size: 1.4em;
    padding-bottom: 0.3em;
    border-bottom: 1px solid var(--border);
}

.markdown-content h2 { font-size: 1.25em; }
.markdown-content h3 { font-size: 1.1em; }
.markdown-content h4 { font-size: 1em; }

.markdown-content p {
    margin: 0.5em 0;
}

.markdown-content ul,
.markdown-content ol {
    margin: 0.5em 0;
    padding-left: 1.5em;
}

.markdown-content ul { list-style-type: disc; }
.markdown-content ol { list-style-type: decimal; }

.markdown-content li {
    margin: 0.25em 0;
}

.markdown-content pre {
    margin: 0.75em 0;
    padding: 12px 14px;
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-muted);
    overflow-x: auto;
    font-family: var(--mono);
    font-size: 13px;
    line-height: 1.5;
}

.markdown-content code {
    font-family: var(--mono);
    font-size: 0.9em;
}

.markdown-content :not(pre) > code {
    padding: 0.15em 0.4em;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    background: var(--bg-muted);
}

.markdown-content a {
    color: var(--accent);
    text-decoration: underline;
    text-underline-offset: 2px;
}

.markdown-content a:hover {
    opacity: 0.8;
}

.markdown-content blockquote {
    margin: 0.75em 0;
    padding: 8px 12px;
    border-left: 3px solid var(--border-strong);
    background: var(--bg-muted);
    color: var(--muted);
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

.markdown-content table {
    margin: 0.75em 0;
    border-collapse: collapse;
    width: 100%;
    font-size: 13px;
}

.markdown-content th,
.markdown-content td {
    border: 1px solid var(--border);
    padding: 8px 12px;
    text-align: left;
    color: var(--text);
}

.markdown-content th {
    font-family: var(--mono);
    font-weight: 500;
    color: var(--text);
    background: var(--bg-muted);
}

.markdown-content hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 1.5em 0;
}

.markdown-content strong {
    font-weight: 600;
    color: var(--text-strong);
}

.markdown-content em {
    font-style: italic;
}

/* =============================================================================
   Dialogs / Modals
   ============================================================================= */

.mitto-dialog-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
    z-index: 200;
}

.mitto-dialog {
    width: min(480px, 100%);
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 24px;
    animation: scaleIn 0.2s var(--ease-out);
    box-shadow: var(--shadow-lg);
}

.mitto-dialog__header {
    margin-bottom: 16px;
}

.mitto-dialog__title {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-strong);
}

.mitto-dialog__subtitle {
    font-size: 14px;
    color: var(--muted);
    margin-top: 4px;
}

.mitto-dialog__content {
    margin-bottom: 20px;
}

.mitto-dialog__actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

/* =============================================================================
   Form Elements
   ============================================================================= */

.mitto-input {
    width: 100%;
    padding: 10px 14px;
    font-family: var(--font-body);
    font-size: 14px;
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-elevated);
    color: var(--text);
    outline: none;
    transition: border-color var(--duration-fast), box-shadow var(--duration-fast);
}

.mitto-input::placeholder {
    color: var(--muted);
}

.mitto-input:focus {
    border-color: var(--accent);
    box-shadow: var(--focus-ring);
}

.mitto-input:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* =============================================================================
   Utility Classes (Tailwind-compatible overrides)
   Light theme overrides (default for v2-theme)
   ============================================================================= */

/* Light theme: Background colors - slate palette */
.v2-theme:not(.dark) .bg-slate-900 { background: #fafafa !important; }
.v2-theme:not(.dark) .bg-slate-800 { background: #f5f5f5 !important; }
.v2-theme:not(.dark) .bg-slate-800\/50 { background: rgba(245, 245, 245, 0.8) !important; }
.v2-theme:not(.dark) .bg-slate-700 { background: #ffffff !important; }
.v2-theme:not(.dark) .bg-slate-700\/50 { background: rgba(240, 240, 240, 0.5) !important; }
.v2-theme:not(.dark) .bg-slate-600 { background: #f0f0f0 !important; }

/* Light theme: Mitto custom background classes */
.v2-theme:not(.dark) .bg-mitto-sidebar { background: #ffffff !important; }
.v2-theme:not(.dark) .bg-mitto-bg { background: #fafafa !important; }
.v2-theme:not(.dark) .bg-mitto-chat { background: #f5f5f5 !important; }
.v2-theme:not(.dark) .bg-mitto-input { background: #ffffff !important; }
.v2-theme:not(.dark) .bg-mitto-input-box {
    background: #f5f5f5 !important;
    color: #18181b !important;
}

/* Light theme: Text colors */
.v2-theme:not(.dark) .text-white { color: #18181b !important; }
.v2-theme:not(.dark) .text-gray-100 { color: #3f3f46 !important; }
.v2-theme:not(.dark) .text-gray-200 { color: #3f3f46 !important; }
.v2-theme:not(.dark) .text-gray-300 { color: #52525b !important; }
.v2-theme:not(.dark) .text-gray-400 { color: #71717a !important; }
.v2-theme:not(.dark) .text-gray-500 { color: #71717a !important; }

/* Light theme: Placeholder text */
.v2-theme:not(.dark) .placeholder-gray-400::placeholder { color: #a1a1aa !important; }
.v2-theme:not(.dark) .placeholder-gray-500::placeholder { color: #a1a1aa !important; }
.v2-theme:not(.dark) textarea::placeholder { color: #a1a1aa !important; }
.v2-theme:not(.dark) input::placeholder { color: #a1a1aa !important; }

/* Light theme: Border colors */
.v2-theme:not(.dark) .border-slate-700 { border-color: #e4e4e7 !important; }
.v2-theme:not(.dark) .border-slate-600 { border-color: #d4d4d8 !important; }
.v2-theme:not(.dark) .border-slate-500 { border-color: #a1a1aa !important; }

/* Light theme: Hover states - backgrounds */
.v2-theme:not(.dark) .hover\:bg-slate-700:hover { background: #f0f0f0 !important; }
.v2-theme:not(.dark) .hover\:bg-slate-700\/50:hover { background: rgba(240, 240, 240, 0.7) !important; }
.v2-theme:not(.dark) .hover\:bg-slate-600:hover { background: #e5e5e5 !important; }

/* Light theme: Hover states - text */
.v2-theme:not(.dark) .hover\:text-white:hover { color: #18181b !important; }

/* Light theme: Focus states */
.v2-theme:not(.dark) .focus\:ring-blue-500:focus {
    --tw-ring-color: #dc2626 !important;
    box-shadow: 0 0 0 2px #fafafa, 0 0 0 4px #dc2626 !important;
}

/* =============================================================================
   Dark Theme Overrides
   Applied when .v2-theme.dark is present
   ============================================================================= */

/* Dark theme: Background colors - use original dark slate colors */
.v2-theme.dark .bg-slate-900 { background: #0f172a !important; }
.v2-theme.dark .bg-slate-800 { background: #1e293b !important; }
.v2-theme.dark .bg-slate-800\/50 { background: rgba(30, 41, 59, 0.5) !important; }
.v2-theme.dark .bg-slate-700 { background: #334155 !important; }
.v2-theme.dark .bg-slate-700\/50 { background: rgba(51, 65, 85, 0.5) !important; }
.v2-theme.dark .bg-slate-600 { background: #475569 !important; }

/* Dark theme: Mitto custom background classes */
.v2-theme.dark .bg-mitto-sidebar { background: #1a1d25 !important; }
.v2-theme.dark .bg-mitto-bg { background: #12141a !important; }
.v2-theme.dark .bg-mitto-chat { background: #14161d !important; }
.v2-theme.dark .bg-mitto-input { background: #1a1d25 !important; }
.v2-theme.dark .bg-mitto-input-box {
    background: #262a35 !important;
    color: #e4e4e7 !important;
}

/* Dark theme: Text colors - restore original light text */
.v2-theme.dark .text-white { color: #ffffff !important; }
.v2-theme.dark .text-gray-100 { color: #f3f4f6 !important; }
.v2-theme.dark .text-gray-200 { color: #e5e7eb !important; }
.v2-theme.dark .text-gray-300 { color: #d1d5db !important; }
.v2-theme.dark .text-gray-400 { color: #a1a1aa !important; }
.v2-theme.dark .text-gray-500 { color: #9ca3af !important; }

/* Dark theme: Placeholder text */
.v2-theme.dark .placeholder-gray-400::placeholder { color: #9ca3af !important; }
.v2-theme.dark .placeholder-gray-500::placeholder { color: #9ca3af !important; }
.v2-theme.dark textarea::placeholder { color: #9ca3af !important; }
.v2-theme.dark input::placeholder { color: #9ca3af !important; }

/* Dark theme: Border colors - restore original dark borders */
.v2-theme.dark .border-slate-700 { border-color: #334155 !important; }
.v2-theme.dark .border-slate-600 { border-color: #475569 !important; }
.v2-theme.dark .border-slate-500 { border-color: #64748b !important; }

/* Dark theme: Hover states - backgrounds */
.v2-theme.dark .hover\:bg-slate-700:hover { background: #334155 !important; }
.v2-theme.dark .hover\:bg-slate-700\/50:hover { background: rgba(51, 65, 85, 0.5) !important; }
.v2-theme.dark .hover\:bg-slate-600:hover { background: #475569 !important; }

/* Dark theme: Hover states - text */
.v2-theme.dark .hover\:text-white:hover { color: #ffffff !important; }

/* Dark theme: Focus states */
.v2-theme.dark .focus\:ring-blue-500:focus {
    --tw-ring-color: #ff5c5c !important;
    box-shadow: 0 0 0 2px #12141a, 0 0 0 4px #ff5c5c !important;
}

/* =============================================================================
   Accent Colors (both themes)
   ============================================================================= */

/* Light theme accent (red) */
.v2-theme:not(.dark) .bg-blue-500 { background: #dc2626 !important; }
.v2-theme:not(.dark) .bg-blue-600 { background: #dc2626 !important; }
.v2-theme:not(.dark) .bg-blue-700 { background: #b91c1c !important; }
.v2-theme:not(.dark) .hover\:bg-blue-600:hover { background: #ef4444 !important; }
.v2-theme:not(.dark) .hover\:bg-blue-700:hover { background: #b91c1c !important; }
.v2-theme:not(.dark) .text-blue-400 { color: #dc2626 !important; }
.v2-theme:not(.dark) .text-blue-500 { color: #dc2626 !important; }
.v2-theme:not(.dark) .text-blue-600 { color: #dc2626 !important; }
.v2-theme:not(.dark) .border-blue-500 { border-color: #dc2626 !important; }
.v2-theme:not(.dark) .border-l-blue-500 { border-left-color: #dc2626 !important; }
.v2-theme:not(.dark) .ring-blue-500 { --tw-ring-color: #dc2626 !important; }

/* Light theme: Active session highlight */
.v2-theme:not(.dark) .bg-blue-900\/30 {
    background: rgba(220, 38, 38, 0.08) !important;
    border-left: 2px solid #dc2626 !important;
}

/* Dark theme accent (coral red) */
.v2-theme.dark .bg-blue-500 { background: #ff5c5c !important; }
.v2-theme.dark .bg-blue-600 { background: #ff5c5c !important; }
.v2-theme.dark .bg-blue-700 { background: #ef4444 !important; }
.v2-theme.dark .hover\:bg-blue-600:hover { background: #ff7070 !important; }
.v2-theme.dark .hover\:bg-blue-700:hover { background: #ef4444 !important; }
.v2-theme.dark .text-blue-400 { color: #ff5c5c !important; }
.v2-theme.dark .text-blue-500 { color: #ff5c5c !important; }
.v2-theme.dark .text-blue-600 { color: #ff5c5c !important; }
.v2-theme.dark .border-blue-500 { border-color: #ff5c5c !important; }
.v2-theme.dark .border-l-blue-500 { border-left-color: #ff5c5c !important; }
.v2-theme.dark .ring-blue-500 { --tw-ring-color: #ff5c5c !important; }

/* Dark theme: Active session highlight */
.v2-theme.dark .bg-blue-900\/30 {
    background: rgba(255, 92, 92, 0.15) !important;
    border-left: 2px solid #ff5c5c !important;
}

/* Status colors - keep these vibrant for visibility (both themes) */
.v2-theme .bg-green-400 { background: #22c55e !important; }
.v2-theme .bg-green-500 { background: #16a34a !important; }
.v2-theme:not(.dark) .text-green-400 { color: #16a34a !important; }
.v2-theme:not(.dark) .text-green-500 { color: #16a34a !important; }
.v2-theme.dark .text-green-400 { color: #4ade80 !important; }
.v2-theme.dark .text-green-500 { color: #22c55e !important; }

.v2-theme .bg-red-500 { background: #ef4444 !important; }
.v2-theme .bg-red-600 { background: #dc2626 !important; }
.v2-theme .hover\:bg-red-600:hover { background: #dc2626 !important; }
.v2-theme .hover\:bg-red-700:hover { background: #b91c1c !important; }
.v2-theme:not(.dark) .text-red-400 { color: #dc2626 !important; }
.v2-theme:not(.dark) .text-red-500 { color: #dc2626 !important; }
.v2-theme.dark .text-red-400 { color: #f87171 !important; }
.v2-theme.dark .text-red-500 { color: #ef4444 !important; }

/* Ensure white text on accent-colored buttons (both themes) */
.v2-theme button.bg-red-500,
.v2-theme button.bg-red-600,
.v2-theme button.bg-blue-500,
.v2-theme button.bg-blue-600 {
    color: #ffffff !important;
}
.v2-theme button.bg-red-500:hover,
.v2-theme button.bg-red-600:hover,
.v2-theme button.bg-blue-500:hover,
.v2-theme button.bg-blue-600:hover,
.v2-theme button[class*="hover:bg-red"]:hover,
.v2-theme button[class*="hover:bg-blue"]:hover {
    color: #ffffff !important;
}

.v2-theme .bg-yellow-400 { background: #facc15 !important; }
.v2-theme .bg-yellow-500 { background: #eab308 !important; }
.v2-theme:not(.dark) .text-yellow-400 { color: #ca8a04 !important; }
.v2-theme:not(.dark) .text-yellow-500 { color: #ca8a04 !important; }
.v2-theme.dark .text-yellow-400 { color: #fbbf24 !important; }
.v2-theme.dark .text-yellow-500 { color: #f59e0b !important; }

/* Disabled states - light theme */
.v2-theme:not(.dark) .disabled\:bg-slate-700:disabled { background: #e5e5e5 !important; }
/* Disabled states - dark theme */
.v2-theme.dark .disabled\:bg-slate-700:disabled { background: #334155 !important; }

/* Buttons - light theme: ensure visible borders and backgrounds */
.v2-theme:not(.dark) button:not([class*="bg-blue"]):not([class*="bg-red"]):not([class*="bg-green"]) {
    border: 1px solid #e4e4e7;
}

.v2-theme:not(.dark) button:hover:not([class*="bg-blue"]):not([class*="bg-red"]):not([class*="bg-green"]) {
    background: #f0f0f0;
    border-color: #d4d4d8;
}

/* Buttons - dark theme */
.v2-theme.dark button:not([class*="bg-blue"]):not([class*="bg-red"]):not([class*="bg-green"]) {
    border: 1px solid #334155;
}

.v2-theme.dark button:hover:not([class*="bg-blue"]):not([class*="bg-red"]):not([class*="bg-green"]) {
    background: #334155;
    border-color: #475569;
}

/* Session list items - light theme */
.v2-theme:not(.dark) .cursor-pointer {
    border-bottom: 1px solid #e4e4e7 !important;
}

.v2-theme:not(.dark) .cursor-pointer:hover {
    background: #f5f5f5 !important;
}

/* Session list items - dark theme */
.v2-theme.dark .cursor-pointer {
    border-bottom: 1px solid #334155 !important;
}

.v2-theme.dark .cursor-pointer:hover {
    background: #1e293b !important;
}

/* Session action buttons (rename/delete) - light theme styling */
.v2-theme:not(.dark) .cursor-pointer button.p-1\.5 {
    background: transparent !important;
    border: 1px solid #e4e4e7 !important;
    color: #71717a !important;
}

.v2-theme:not(.dark) .cursor-pointer button.p-1\.5:hover {
    background: #f0f0f0 !important;
    border-color: #d4d4d8 !important;
    color: #3f3f46 !important;
}

/* Session action buttons - dark theme styling */
.v2-theme.dark .cursor-pointer button.p-1\.5 {
    background: transparent !important;
    border: 1px solid #475569 !important;
    color: #9ca3af !important;
}

.v2-theme.dark .cursor-pointer button.p-1\.5:hover {
    background: #334155 !important;
    border-color: #64748b !important;
    color: #e5e7eb !important;
}

/* Delete button hover - light theme */
.v2-theme:not(.dark) .cursor-pointer button[title="Delete"]:hover {
    background: #fef2f2 !important;
    border-color: #fecaca !important;
    color: #dc2626 !important;
}

/* Delete button hover - dark theme */
.v2-theme.dark .cursor-pointer button[title="Delete"]:hover {
    background: rgba(239, 68, 68, 0.2) !important;
    border-color: #f87171 !important;
    color: #f87171 !important;
}

/* Stored badge - light theme */
.v2-theme:not(.dark) .cursor-pointer .bg-slate-700.text-gray-400 {
    background: #f5f5f5 !important;
    color: #71717a !important;
    border: 1px solid #e4e4e7;
}

/* Stored badge - dark theme */
.v2-theme.dark .cursor-pointer .bg-slate-700.text-gray-400 {
    background: #334155 !important;
    color: #9ca3af !important;
    border: 1px solid #475569;
}

/* Scrollbar - light theme */
.v2-theme:not(.dark) ::-webkit-scrollbar-thumb {
    background: #d4d4d8;
}

.v2-theme:not(.dark) ::-webkit-scrollbar-thumb:hover {
    background: #a1a1aa;
}

/* Scrollbar - dark theme */
.v2-theme.dark ::-webkit-scrollbar-thumb {
    background: #475569;
}

.v2-theme.dark ::-webkit-scrollbar-thumb:hover {
    background: #64748b;
}

/* System message badges - light theme */
.v2-theme:not(.dark) .rounded-full.text-xs:not(.workspace-pill) {
    background: #f5f5f5 !important;
    color: #71717a !important;
    border: 1px solid #e4e4e7;
}

/* System message badges - dark theme */
.v2-theme.dark .rounded-full.text-xs:not(.workspace-pill) {
    background: #1e293b !important;
    color: #9ca3af !important;
    border: 1px solid #334155;
}

/* =============================================================================
   Theme Toggle - Sun/Moon Design
   ============================================================================= */

.v2-theme .theme-toggle-v2 {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    padding: 4px 6px;
    background: #f5f5f5;
    border: 1px solid #e4e4e7;
    border-radius: 9999px;
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
    /* Match font-size-toggle height exactly */
    height: 32px;
    box-sizing: border-box;
}

.v2-theme .theme-toggle-v2:hover {
    background: #e5e5e5;
    border-color: #d4d4d8;
}

.v2-theme .theme-toggle-v2__option {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    transition: all 0.2s ease;
    color: #a1a1aa;
}

.v2-theme .theme-toggle-v2__option.active {
    background: #ffffff;
    color: #18181b;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.v2-theme .theme-toggle-v2__option:not(.active):hover {
    color: #71717a;
}

.v2-theme .theme-toggle-v2__option svg {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
    stroke-width: 2px;
    stroke-linecap: round;
    stroke-linejoin: round;
}

/* Dark theme version of the toggle */
.v2-theme.dark .theme-toggle-v2,
.dark .v2-theme .theme-toggle-v2 {
    background: #27272a;
    border-color: #3f3f46;
}

.v2-theme.dark .theme-toggle-v2:hover,
.dark .v2-theme .theme-toggle-v2:hover {
    background: #3f3f46;
    border-color: #52525b;
}

.v2-theme.dark .theme-toggle-v2__option,
.dark .v2-theme .theme-toggle-v2__option {
    color: #71717a;
}

.v2-theme.dark .theme-toggle-v2__option.active,
.dark .v2-theme .theme-toggle-v2__option.active {
    background: #3f3f46;
    color: #fafafa;
}

.v2-theme.dark .theme-toggle-v2__option:not(.active):hover,
.dark .v2-theme .theme-toggle-v2__option:not(.active):hover {
    color: #a1a1aa;
}

/* =============================================================================
   Responsive Adjustments
   ============================================================================= */

@media (max-width: 768px) {
    .mitto-shell {
        grid-template-columns: 1fr;
        grid-template-rows: 56px 1fr;
        grid-template-areas:
            "topbar"
            "content";
    }

    .mitto-sidebar {
        display: none;
    }

    .mitto-sidebar--open {
        display: flex;
        position: fixed;
        inset: 0;
        z-index: 100;
        width: 100%;
        max-width: 320px;
    }

    .mitto-topbar {
        padding: 0 12px;
    }

    .mitto-brand__sub {
        display: none;
    }

    .mitto-thread {
        padding: 12px;
    }

    .mitto-compose {
        padding: 12px;
    }
}

@media (max-width: 480px) {
    .mitto-brand__title {
        font-size: 14px;
    }

    .mitto-bubble {
        padding: 8px 12px;
    }

    .mitto-compose__textarea {
        min-height: 40px;
        padding: 8px 12px;
    }

    .mitto-btn {
        padding: 8px 12px;
        font-size: 12px;
    }
}

/* =============================================================================
   Font Size Toggle (v2 Theme)
   ============================================================================= */

.v2-theme .font-size-toggle {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    padding: 4px 6px;
    background: #f5f5f5;
    border: 1px solid #e4e4e7;
    border-radius: 9999px;
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
    /* Match theme-toggle-v2 height exactly */
    height: 32px;
    box-sizing: border-box;
}

.v2-theme .font-size-toggle:hover {
    background: #e5e5e5;
    border-color: #d4d4d8;
}

.v2-theme .font-size-toggle__option {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    transition: all 0.2s ease;
    color: #a1a1aa;
    font-weight: 600;
    font-size: 11px;
    font-family: system-ui, -apple-system, sans-serif;
}

.v2-theme .font-size-toggle__option--large {
    font-size: 15px;
}

.v2-theme .font-size-toggle__option.active {
    background: #ffffff;
    color: #18181b;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.v2-theme .font-size-toggle__option:not(.active):hover {
    color: #71717a;
}

/* Dark theme for v2 font size toggle */
.v2-theme.dark .font-size-toggle,
.dark .v2-theme .font-size-toggle {
    background: #27272a;
    border-color: #3f3f46;
}

.v2-theme.dark .font-size-toggle:hover,
.dark .v2-theme .font-size-toggle:hover {
    background: #3f3f46;
    border-color: #52525b;
}

.v2-theme.dark .font-size-toggle__option,
.dark .v2-theme .font-size-toggle__option {
    color: #a1a1aa;
}

.v2-theme.dark .font-size-toggle__option.active,
.dark .v2-theme .font-size-toggle__option.active {
    background: #3f3f46;
    color: #fafafa;
}

.v2-theme.dark .font-size-toggle__option:not(.active):hover,
.dark .v2-theme .font-size-toggle__option:not(.active):hover {
    color: #d4d4d8;
}
